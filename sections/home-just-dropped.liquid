{% assign my_array = section.settings.collection-list | split: "| " %}
{% assign collect = 0 %}
<div class="homepage-justdropped">
  <div class="section-header-wrapper">
    <div class="section-header text-left">
      <div class="section-header-title">{{ section.settings.just-dropped-title }}</div>
      <div class="section-header-content">{{ section.settings.just-dropped-description }}</div>
    </div>
    <div class="tab-buttton">
      {% for item in my_array %}
      <div id="titem_{{forloop.index}}" class="tab {% if forloop.first %} active {% endif %} ">
        {{item}}
      </div>
      {% endfor %}
    </div>
  </div>
  <div class="homepage-justdropped-content">
    <!-- TODO: Remove sold ou product from loop -->
    {% for item in my_array %}
    {% assign collect = collections[ item ] %}
    <div class="justdropped-box {% if forloop.first %} active {% endif %}" id="pitem_{{forloop.index}}">
      <div class="test--product-card--grid-four">
        {% for product in collect.products limit:4 %}
        <div class="product__card">
          <div class="product__card--img">
            <a href="{{product.url | within: collection }}" class="product-link">
              <div class="product__image--wrapper">
                {% if product.featured_image != blank %}
                {{ product.featured_image | image_url: width: 400, height: 400, crop: 'bottom' | image_tag : class:
                'product-img', loading: 'lazy', alt: product.feature_image.alt}}
                {% else %}
                {{ 'product-1' | placeholder_svg_tag: 'product-img' }}
                {% endif %}
                <div class="product__status">
                  {% unless product.available %}
                  <!-- TODO: Sold out chip color -->
                  <span class="product__status-soldout">sold out</span>
                  {% endunless %}
                </div>
              </div>
            </a>
            <div class="product__card-cta quick-view-button">
              <a class="quick-view" data-handle="{{ product.handle }}">Quick View</a>
            </div>
          </div>
          <div class="product__card--content">
            <a href="{{product.url | within: collection }}" class="product-link">
              <h2 itemprop="name" class="product__title">{{ product.title }}</h2>
              <!-- TODO: Need to add you save price -->
              <div class="product__variant--price">
                {% if product.price_varies %}
                <p>From {{ product.price_min | money_with_currency }} to {{ product.price_max | money_without_currency
                  }}</p>
                {% else %}
                <p>
                  {% if product.compare_at_price_max > product.price %}
                  <span><s>{{ product.compare_at_price_max | money_with_currency }}</s></span>
                  <span>{{ product.price | money_with_currency }}</span>
                  {% else %}
                  <span>{{ product.price | money_with_currency }}</span>
                  {% endif %}
                </p>
                {% endif %}
              </div>
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endfor %}
  </div>
</div>


{% schema %}
{
  "name": "Just Dropped Section",
  "class": "homepage-section",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "just-dropped-title",
      "label": "Section Title",
      "default": "Just Dropped"
    },
    {
      "type": "text",
      "id": "just-dropped-description",
      "label": "Section Description",
      "default": "New arrivals you will love"
    },
    {
      "type": "number",
      "id": "just-dropped-count",
      "label": "Product Count",
      "default": 4
    },
    {
      "type": "text",
      "id": "collection-list",
      "label": "Collection List"
    },
    {
      "type": "paragraph",
      "content": "enter collection name and use | as separator, use only 4 collection"
    }
  ]
}
{% endschema %}
