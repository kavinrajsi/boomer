<div class="instagram-feed">

    <div class="section-header text-center">
      <div class="section-header-title">{{ section.settings.instagram-title }}</div>
      <div class="section-header-content">
        <p>{{ section.settings.instagram-description }}</p>
      </div>
    </div>

  <div class="section-content">
    <div class="instagram__post--wrapper">
      {% for block in section.blocks %}
      {% if block.settings.image %}
      <div class="instagram__post--image">
        <a href="https://www.instagram.com/sundari_silks/" target="_blank">
          {{ block.settings.image | image_url : width: 264, height: 290, crop: 'top' | image_tag : alt: block.settings.image.alt,
            loading: 'lazy', class: "instagram-item-image" }}
        </a>
      </div>
      {% endif %}
    {% endfor %}
    </div>
  </div>
</div>

<div id="instagramRoot"></div>

<script>
  let request = new XMLHttpRequest;
let  output;
request.open('GET', 'https://graph.instagram.com/5879946881/media?fields=id,media_type,media_url,username,timestamp&access_token=AQCZPMO7NZEVDiIORKhMvIWytMKLjcVPqAXf98vNl1oS5GQvl4kRLHFR_mjpY3VTFVZ084nAao2pi8GzXNw7wCltNFrJP0yjwCkrekQeW3QcWWlhkrKeu8fVKTm3GRY41_tO0euAmARSjUPSN_moa6ebc7yJ0t6Be6xYLGfk03cAt1EXX27-8l9S-GBl9S7vQv36CMKyvpNXBICB5y72g-_vi5VY0fDul9YyqWiNiyBF1A#_');
          request.send();
          request.onload = function () {
           console.log(JSON.parse(this.response));
            let restCountries = JSON.parse(this.response);
            let tryMe = restCountries.data;
              tryMe.forEach(country => {
                output = `
                <div class="col col-sm-6 col-md-4 col-lg-3 col-xl-3 mt-3">
          <div class="card" style="height: 100%;">`
         if( (country.media_type) === "VIDEO"){output += ` <video controls>
           <source src="${country.media_url}">
           </video>`;

           } else{
           output += ` <img src="${country.media_url}" alt="${country.id}" class="" >`; }
           output +=`
            </div>
      </div>
                    `;
              document.getElementsByClassName("kft-instagram-widget")[0].innerHTML += output;
document.getElementById("instagramRoot").innerHTML += output;
          });
          };
</script>


{% schema %}
{
"name": "Instagram Section",
"class": "homepage-section",
"tag": "section",
"settings": [
{
"type": "text",
"id": "instagram-title",
"label": "Section Title",
"default": "Follow us on Instagram"
},
{
"type": "text",
"id": "instagram-description",
"label": "Section Description",
"default": "Use #SundariAndYou when you Instagram your favourite Sundari outfits"
}
],
"blocks": [
{
"type": "instagram-image",
"name": "Instagram Image Section",
"limit": 4,
"settings": [
{
"type": "image_picker",
"id": "image",
"label": "Image"
},
{
"type": "url",
"id": "link",
"label": "Image link"
}
]
}
]
}
{% endschema %}
